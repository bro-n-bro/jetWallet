{"version":3,"file":"js/470.b1f43de1.js","mappings":"u0BAkFI,MAAMA,GAASC,EAAAA,EAAAA,MACXC,GAAUC,EAAAA,EAAAA,KAAI,GACdC,GAAUD,EAAAA,EAAAA,IAAI,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,KACnCE,GAAQF,EAAAA,EAAAA,IAAI,IACZG,GAAUH,EAAAA,EAAAA,IAAI,IACdI,GAAWJ,EAAAA,EAAAA,KAAI,IACf,aAAEK,IAAiBC,EAAAA,EAAAA,KAwCvB,SAASC,EAAUC,EAAOC,GAClBD,EAAME,OAAOC,MAAMC,QAAU,GAAKH,EAAY,GAC9CD,EAAME,OAAOG,QAAQ,QAAQC,cAAc,oBAAoBL,EAAY,YAAYM,OAE/F,CAIA,SAASC,EAASR,EAAOS,GACrBC,YAAW,KAC2B,IAA9BV,EAAME,OAAOC,MAAMC,QAAgBK,EAAe,GAClDT,EAAME,OAAOG,QAAQ,QAAQC,cAAc,oBAAoBG,YAAuBE,QAC1F,GAER,C,OAnDAC,EAAAA,EAAAA,KAAcC,UAEVnB,EAAMS,YAAcW,EAAAA,EAAAA,IAAQ,SAAU,OAGtCnB,EAAQQ,YAAcW,EAAAA,EAAAA,IAAQ,SAAU,WAGxCvB,EAAQY,OAAQ,CAAK,KAIzBY,EAAAA,EAAAA,IAAMtB,EAAQU,OAAOU,UAKjB,GAHAjB,EAASO,OAAQ,EAGbV,EAAQU,MAAM,GAAGC,OAAQ,CAEzB,IAAIY,QAAgBC,EAAAA,EAAAA,IAAgBxB,EAAQU,MAAMe,KAAK,IAAKvB,EAAQQ,OAGhEa,IAAYtB,EAAMS,OAElBN,EAAaM,OAAQ,EAGrBd,EAAO8B,KAAK,aAGZvB,EAASO,OAAQ,CAEzB,K,08ECrHR,MAAMiB,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://cosmos-telegram-signer/./src/views/AuthPage.vue","webpack://cosmos-telegram-signer/./src/views/AuthPage.vue?a80b"],"sourcesContent":["<template>\n    <section class=\"page_container careate_pin_page\">\n        <div class=\"cont\">\n            <div class=\"page_title\">\n                {{ $t('message.auth_title') }}\n            </div>\n\n            <div class=\"page_data_wrap\">\n                <div class=\"page_data\">\n                    <Loader v-if=\"loading\" />\n\n                    <template v-else>\n                    <div class=\"pin\">\n                        <div class=\"label\">\n                            {{ $t('message.create_pin_create_pin_label') }}\n                        </div>\n\n                        <div class=\"row\" :class=\"{ error: wrongPin }\">\n                            <div class=\"field\">\n                                <input type=\"password\" class=\"input big\" v-model=\"pinCode[0]\" maxlength=\"1\" inputmode=\"numeric\"\n                                    @input=\"moveFocus($event, 1)\"\n                                    @keydown.backspace=\"moveBack($event, 0)\">\n                            </div>\n\n                            <div class=\"field\">\n                                <input type=\"password\" class=\"input big\" v-model=\"pinCode[1]\" maxlength=\"1\" inputmode=\"numeric\" :disabled=\"!pinCode[0].length\"\n                                    @input=\"moveFocus($event, 2)\"\n                                    @keydown.backspace=\"moveBack($event, 1)\">\n                            </div>\n\n                            <div class=\"field\">\n                                <input type=\"password\" class=\"input big\" v-model=\"pinCode[2]\" maxlength=\"1\" inputmode=\"numeric\" :disabled=\"!pinCode[1].length\"\n                                    @input=\"moveFocus($event, 3)\"\n                                    @keydown.backspace=\"moveBack($event, 2)\">\n                            </div>\n\n                            <div class=\"field\">\n                                <input type=\"password\" class=\"input big\" v-model=\"pinCode[3]\" maxlength=\"1\" inputmode=\"numeric\" :disabled=\"!pinCode[2].length\"\n                                    @input=\"moveFocus($event, 4)\"\n                                    @keydown.backspace=\"moveBack($event, 3)\">\n                            </div>\n\n                            <div class=\"field\">\n                                <input type=\"password\" class=\"input big\" v-model=\"pinCode[4]\" maxlength=\"1\" inputmode=\"numeric\" :disabled=\"!pinCode[3].length\"\n                                    @input=\"moveFocus($event, 5)\"\n                                    @keydown.backspace=\"moveBack($event, 4)\">\n                            </div>\n\n                            <div class=\"field\">\n                                <input type=\"password\" class=\"input big\" v-model=\"pinCode[5]\" maxlength=\"1\" inputmode=\"numeric\" :disabled=\"!pinCode[4].length\"\n                                    @input=\"moveFocus($event, 6)\"\n                                    @keydown.backspace=\"moveBack($event, 5)\">\n                            </div>\n                        </div>\n\n                        <!-- <div class=\"warning\">You have 3 attempts left</div> -->\n                    </div>\n\n                    <button class=\"biometric_btn\" @click.prevent=\"getBiometric\">\n                        <span>{{ $t('message.btn_biometric2') }}</span>\n\n                        <svg class=\"icon\"><use xlink:href=\"@/assets/sprite.svg#ic_biometric\"></use></svg>\n                    </button>\n                    </template>\n                </div>\n            </div>\n        </div>\n    </section>\n</template>\n\n\n<script setup>\n    import { onBeforeMount, ref, watch } from 'vue'\n    import { useRouter } from 'vue-router'\n    import { hashDataWithKey } from '@/utils'\n    import { getData } from '@/utils/db'\n    import { useGlobalState } from '@/store'\n\n    // Components\n    import Loader from '@/components/Loader.vue'\n\n\n    const router = useRouter(),\n        loading = ref(true),\n        pinCode = ref(['', '', '', '', '', '']),\n        pinDB = ref(''),\n        hmacKey = ref(''),\n        wrongPin = ref(false),\n        { isAuthorized } = useGlobalState()\n\n\n    onBeforeMount(async () => {\n        // Get pin from DB\n        pinDB.value = await getData('wallet', 'pin')\n\n        // Get hmacKey from DB\n        hmacKey.value = await getData('wallet', 'hmacKey')\n\n        // Hide loader\n        loading.value = false\n    })\n\n\n    watch(pinCode.value, async () => {\n        // Reset data\n        wrongPin.value = false\n\n        // Compare pins\n        if (pinCode.value[5].length) {\n            // Encrypt the PIN\n            let pinHash = await hashDataWithKey(pinCode.value.join(''), hmacKey.value)\n\n            // Check the PIN\n            if (pinHash === pinDB.value) {\n                // Set authorized status\n                isAuthorized.value = true\n\n                // Redirect\n                router.push('/account')\n            } else {\n                // Set error\n                wrongPin.value = true\n            }\n        }\n    })\n\n\n    // Move focus\n    function moveFocus(event, nextIndex) {\n        if (event.target.value.length >= 1 && nextIndex < 6) {\n            event.target.closest('.row').querySelector(`.field:nth-child(${nextIndex + 1}) input`).focus()\n        }\n    }\n\n\n    // Move back\n    function moveBack(event, currentIndex) {\n        setTimeout(() => {\n            if (event.target.value.length === 0 && currentIndex > 0) {\n                event.target.closest('.row').querySelector(`.field:nth-child(${currentIndex}) input`).select()\n            }\n        })\n    }\n</script>\n\n\n<style scoped>\n.pin\n{\n    position: relative;\n\n    margin-top: 8px;\n}\n\n\n.pin .label\n{\n    font-size: 14px;\n\n    margin-bottom: 2px;\n    padding: 0 10px;\n}\n\n\n.pin .row\n{\n    flex-wrap: nowrap;\n}\n\n\n.pin .row > *\n{\n    width: 100%;\n}\n\n\n.pin .row > * + *\n{\n    margin-left: 10px;\n}\n\n\n.pin .input\n{\n    font-size: 20px;\n\n    text-align: center;\n}\n\n\n.pin .error .input\n{\n    border-color: #f00;\n}\n\n.pin .success .input\n{\n    border-color: #00aa63;\n}\n\n\n.pin .warning\n{\n    font-size: 12px;\n\n    position: absolute;\n    top: 100%;\n    left: 0;\n\n    width: 100%;\n    margin-top: 4px;\n\n    text-align: center;\n\n    color: #ff4b4b;\n}\n\n\n\n.biometric_btn\n{\n    font-size: 18px;\n    font-weight: 500;\n\n    display: block;\n\n    margin: auto auto 25%;\n\n    transition: opacity .2s linear;\n}\n\n.biometric_btn.top\n{\n    margin-top: 40px;\n}\n\n\n.biometric_btn .icon\n{\n    display: block;\n\n    width: 44px;\n    height: 44px;\n    margin: 0 auto;\n}\n\n\n.biometric_btn.disabled\n{\n    pointer-events: none;\n\n    opacity: .6;\n}\n\n\n\n</style>","import script from \"./AuthPage.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./AuthPage.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./AuthPage.vue?vue&type=style&index=0&id=76af050c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-76af050c\"]])\n\nexport default __exports__"],"names":["router","useRouter","loading","ref","pinCode","pinDB","hmacKey","wrongPin","isAuthorized","useGlobalState","moveFocus","event","nextIndex","target","value","length","closest","querySelector","focus","moveBack","currentIndex","setTimeout","select","onBeforeMount","async","getData","watch","pinHash","hashDataWithKey","join","push","__exports__"],"sourceRoot":""}