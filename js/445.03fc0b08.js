"use strict";(self["webpackChunkcosmos_telegram_signer"]=self["webpackChunkcosmos_telegram_signer"]||[]).push([[445],{89114:function(e,a,t){t.d(a,{A:function(){return v}});var l=t(56768);const n={class:"loader_wrap"},i=(0,l.Lk)("div",{class:"loader"},[(0,l.Lk)("span")],-1),s=[i];function u(e,a){return(0,l.uX)(),(0,l.CE)("div",n,s)}var o=t(71241);const c={},r=(0,o.A)(c,[["render",u]]);var v=r},62445:function(e,a,t){t.r(a),t.d(a,{default:function(){return ae}});t(44114);var l=t(56768),n=t(24232),i=t(45130),s=t(90144),u=t(24113),o=t(81387),c=t(61981),r=t(63995),v=t(89114),d=t(36571);const p=u+"#ic_close",m={class:"modal"},g={class:"modal_content"},k={class:"data"},b=(0,l.Lk)("svg",{class:"icon"},[(0,l.Lk)("use",{"xlink:href":p})],-1),h={class:"modal_title"},_={class:"modal_desc"},L={class:"btns"},f=(0,l.Lk)("div",{class:"overlay"},null,-1);var w={__name:"AuthErrorModal",setup(e){const a=(0,s.KR)(!0);return(0,l.KC)((async()=>{await(0,d.clearData)("wallet"),a.value=!1})),(e,a)=>{const t=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("section",m,[(0,l.Lk)("div",g,[(0,l.Lk)("div",k,[(0,l.bF)(t,{to:"/",class:"close_btn"},{default:(0,l.k6)((()=>[b])),_:1}),(0,l.Lk)("div",h,(0,n.v_)(e.$t("message.auth_error_title")),1),(0,l.Lk)("div",_,(0,n.v_)(e.$t("message.auth_error_desc")),1),(0,l.Lk)("div",L,[(0,l.bF)(t,{to:"/import_wallet",class:"btn"},{default:(0,l.k6)((()=>[(0,l.Lk)("span",null,(0,n.v_)(e.$t("message.btn_import_existing_wallet")),1)])),_:1})])])]),f])}}};const y=w;var C=y;const K=e=>((0,l.Qi)("data-v-610e797c"),e=e(),(0,l.jt)(),e),R=u+"#ic_biometric_face",E=u+"#ic_biometric_finger",A={class:"page_container careate_pin_page"},x={class:"cont"},$={class:"page_title"},X={class:"page_data_wrap"},B={class:"page_data"},T={class:"label"},W={class:"field"},j={class:"field"},U=["disabled"],I={class:"field"},M=["disabled"],D={class:"field"},J=["disabled"],Q={class:"field"},V=["disabled"],q={class:"field"},F=["disabled"],S={key:0,class:"warning"},z={key:0,class:"icon"},G=K((()=>(0,l.Lk)("use",{"xlink:href":R},null,-1))),P=[G],H={key:1,class:"icon"},N=K((()=>(0,l.Lk)("use",{"xlink:href":E},null,-1))),O=[N];var Y={__name:"AuthPage",setup(e){const a=(0,r.o)(),t=(0,o.rd)(),u=(0,s.KR)(!0),d=(0,s.KR)(["","","","","",""]),p=(0,s.KR)(""),m=(0,s.KR)(""),g=(0,s.KR)(!1),k=(0,s.KR)(!1),b=(0,s.KR)(!1),h=(0,s.KR)(!1),_=(0,s.KR)("finger"),L=(0,s.KR)(!1),f=(0,s.KR)(null);function w(e,a){e.target.value.length>=1&&a<6&&e.target.closest(".row").querySelector(`.field:nth-child(${a+1}) input`).focus()}function y(e,a){setTimeout((()=>{0===e.target.value.length&&a>0&&e.target.closest(".row").querySelector(`.field:nth-child(${a}) input`).select()}))}function K(){Telegram.WebApp.isAccessGranted?R():Telegram.WebApp.BiometricManager.requestAccess({reason:"Наш текст"},(()=>R()))}function R(){Telegram.WebApp.BiometricManager.authenticate({reason:"Наш текст"},(e=>{e&&Z(e)}))}(0,l.KC)((async()=>{let e=await a.getMultipleData(["pin","hmacKey","authErrorLimit","isBiometric"]);p.value=e.pin,m.value=e.hmacKey,k.value=e.authErrorLimit,b.value=e.isBiometric,h.value=Telegram.WebApp.BiometricManager.isBiometricAvailable,"unknown"!=Telegram.WebApp.BiometricManager.biometricType&&(_.value=Telegram.WebApp.BiometricManager.biometricType),u.value=!1,h.value&&b.value&&K()})),(0,l.wB)(d.value,(()=>{d.value[5].length&&document.activeElement.blur(),d.value[5].length&&k.value===a.authErrorLimit&&G()}));const E=(0,l.EW)((()=>""!=d.value[5].length));async function G(){let e=await N();e?Z():await Y()}async function N(){let e=await(0,c.mK)(d.value.join(""),m.value);return e===p.value}async function Y(){g.value=!0;let e=k.value-1;k.value=e,e?a.updateUserAuthErrorLimit(e):L.value=!0,d.value=["","","","","",""],g.value=!1}async function Z(){a.updateUserAuthErrorLimit(a.authErrorLimit),a.isAuthorized=!0,t.push("/account")}async function ee(){a.clearAllData(),t.push("/")}return(e,t)=>((0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("section",A,[(0,l.Lk)("div",x,[(0,l.Lk)("div",$,(0,n.v_)(e.$t("message.auth_title")),1),(0,l.Lk)("div",X,[(0,l.Lk)("div",B,[u.value?((0,l.uX)(),(0,l.Wv)(v.A,{key:0})):(0,l.Q3)("",!0),(0,l.Lk)("div",{class:(0,n.C4)(["pin",{show:!u.value}])},[(0,l.Lk)("div",T,(0,n.v_)(e.$t("message.auth_enter_pin_label")),1),(0,l.Lk)("div",{class:(0,n.C4)(["row",{error:g.value}])},[(0,l.Lk)("div",W,[(0,l.bo)((0,l.Lk)("input",{type:"password",class:(0,n.C4)(["input big",{active:d.value[0].length}]),"onUpdate:modelValue":t[0]||(t[0]=e=>d.value[0]=e),maxlength:"1",inputmode:"numeric",ref_key:"inputRef",ref:f,onInput:t[1]||(t[1]=e=>w(e,1)),onKeydown:t[2]||(t[2]=(0,i.jR)((e=>y(e,0)),["backspace"]))},null,34),[[i.Jo,d.value[0]]])]),(0,l.Lk)("div",j,[(0,l.bo)((0,l.Lk)("input",{type:"password",class:(0,n.C4)(["input big",{active:d.value[1].length}]),"onUpdate:modelValue":t[3]||(t[3]=e=>d.value[1]=e),maxlength:"1",inputmode:"numeric",disabled:!d.value[0].length,onInput:t[4]||(t[4]=e=>w(e,2)),onKeydown:t[5]||(t[5]=(0,i.jR)((e=>y(e,1)),["backspace"]))},null,42,U),[[i.Jo,d.value[1]]])]),(0,l.Lk)("div",I,[(0,l.bo)((0,l.Lk)("input",{type:"password",class:(0,n.C4)(["input big",{active:d.value[2].length}]),"onUpdate:modelValue":t[6]||(t[6]=e=>d.value[2]=e),maxlength:"1",inputmode:"numeric",disabled:!d.value[1].length,onInput:t[7]||(t[7]=e=>w(e,3)),onKeydown:t[8]||(t[8]=(0,i.jR)((e=>y(e,2)),["backspace"]))},null,42,M),[[i.Jo,d.value[2]]])]),(0,l.Lk)("div",D,[(0,l.bo)((0,l.Lk)("input",{type:"password",class:(0,n.C4)(["input big",{active:d.value[3].length}]),"onUpdate:modelValue":t[9]||(t[9]=e=>d.value[3]=e),maxlength:"1",inputmode:"numeric",disabled:!d.value[2].length,onInput:t[10]||(t[10]=e=>w(e,4)),onKeydown:t[11]||(t[11]=(0,i.jR)((e=>y(e,3)),["backspace"]))},null,42,J),[[i.Jo,d.value[3]]])]),(0,l.Lk)("div",Q,[(0,l.bo)((0,l.Lk)("input",{type:"password",class:(0,n.C4)(["input big",{active:d.value[4].length}]),"onUpdate:modelValue":t[12]||(t[12]=e=>d.value[4]=e),maxlength:"1",inputmode:"numeric",disabled:!d.value[3].length,onInput:t[13]||(t[13]=e=>w(e,5)),onKeydown:t[14]||(t[14]=(0,i.jR)((e=>y(e,4)),["backspace"]))},null,42,V),[[i.Jo,d.value[4]]])]),(0,l.Lk)("div",q,[(0,l.bo)((0,l.Lk)("input",{type:"password",class:(0,n.C4)(["input big",{active:d.value[5].length}]),"onUpdate:modelValue":t[15]||(t[15]=e=>d.value[5]=e),maxlength:"1",inputmode:"numeric",disabled:!d.value[4].length,onInput:t[16]||(t[16]=e=>w(e,6)),onKeydown:t[17]||(t[17]=(0,i.jR)((e=>y(e,5)),["backspace"]))},null,42,F),[[i.Jo,d.value[5]]])])],2),k.value<(0,s.R1)(a).authErrorLimit?((0,l.uX)(),(0,l.CE)("div",S,(0,n.v_)(e.$t("message.auth_error_warning",{count:k.value})),1)):(0,l.Q3)("",!0)],2),h.value&&k.value==(0,s.R1)(a).authErrorLimit?((0,l.uX)(),(0,l.CE)("button",{key:1,class:(0,n.C4)(["biometric_btn",{show:!u.value}]),onClick:(0,i.D$)(K,["prevent"])},[(0,l.Lk)("span",null,(0,n.v_)(e.$t("message.btn_biometric2")),1),"face"===_.value?((0,l.uX)(),(0,l.CE)("svg",z,P)):((0,l.uX)(),(0,l.CE)("svg",H,O))],2)):(0,l.Q3)("",!0),(0,l.Lk)("div",{class:(0,n.C4)(["btns",{show:!u.value}])},[k.value<(0,s.R1)(a).authErrorLimit?((0,l.uX)(),(0,l.CE)("button",{key:0,class:(0,n.C4)(["btn",{disabled:!E.value}]),onClick:t[18]||(t[18]=(0,i.D$)((e=>G()),["prevent"]))},[(0,l.Lk)("span",null,(0,n.v_)(e.$t("message.btn_login")),1)],2)):(0,l.Q3)("",!0)],2),(0,l.Lk)("button",{onClick:(0,i.D$)(ee,["prevent"]),style:{margin:"20px auto 0",width:"70px"}},"Удалить всё")])])])]),L.value?((0,l.uX)(),(0,l.Wv)(C,{key:0})):(0,l.Q3)("",!0)],64))}},Z=t(71241);const ee=(0,Z.A)(Y,[["__scopeId","data-v-610e797c"]]);var ae=ee},24113:function(e,a,t){e.exports=t.p+"img/sprite.b89ce33f.svg"}}]);
//# sourceMappingURL=445.03fc0b08.js.map